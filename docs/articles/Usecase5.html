<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CRTspat">
<title>Use Case 5: Analysis of trials (including methods for analysing contamination) • CRTspat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use Case 5: Analysis of trials (including methods for analysing contamination)">
<meta property="og:description" content="CRTspat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CRTspat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/CRTspat.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Usecase1.html">Use Case 1: Algorithmic specification of clusters and of buffer zones</a>
    <a class="dropdown-item" href="../articles/Usecase2.html">Use Case 2: Simulation of trials with geographical contamination</a>
    <a class="dropdown-item" href="../articles/Usecase3.html">Use Case 3: Estimation of intracluster correlations (ICC) by cluster size</a>
    <a class="dropdown-item" href="../articles/Usecase4.html">Use Case 4: Estimation of optimal cluster size for a trial with pre-determined buffer width</a>
    <a class="dropdown-item" href="../articles/Usecase5.html">Use Case 5: Analysis of trials (including methods for analysing contamination)</a>
    <a class="dropdown-item" href="../articles/Usecase7.html">Use Case 7: Preparation of datasets for `CRTspat`</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Use Case 5: Analysis of trials (including methods for analysing contamination)</h1>
            
      
      
      <div class="d-none name"><code>Usecase5.Rmd</code></div>
    </div>

    
    
<!--To build the vignette
# since the vignette takes a long time to run, it is not run with every build
# as suggested here https://ropensci.org/blog/2019/12/08/precompute-vignettes/
# to Knit this vignette without this time consuming step being part of the default build
knitr::knit("vignettes/Usecase5.Rmd.orig", output = "vignettes/Usecase5.Rmd")
rmarkdown.html_vignette.check_title = FALSE
devtools::install(build_vignettes = TRUE)
-->
<p>The <a href="../reference/CRTanalysis.html"><code>CRTanalysis</code></a> The
function <code>CRTanalysis</code> is a wrapper for several different
statistical analysis packages that can be used to analyse either
simulated or real trial datasets. The different options are specified
using the <code>method</code> argument of the function.</p>
<ul>
<li>
<code>method = "T" summarises the outcome at the level of the cluster and uses t-tests to carry out statistical significance tests of the effect, and to compute confidence intervals for the effect size. This uses the [t.test](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test) function in the</code>stats`
package.</li>
<li>
<code>method = "GEE"</code> uses Generalised Estimating Equations to
estimate the efficacy in a model with iid random effects for the
clusters. An estimate of the intracluster correlation (ICC) is also
provided. This uses calls to the <a href="https://www.jstatsoft.org/article/view/v015i02" class="external-link">geepack</a>
package.</li>
<li>`method = “MCMC”. <a href="https://cran.r-project.org/web/packages/jagsUI/index.html" class="external-link">jagsUI</a>
</li>
<li>
<code>method = "INLA"</code>uses approximate Bayesian inference via
the <a href="https://www.r-inla.org/" class="external-link">R-INLA package</a>. This provides
functionality for geostatistical analysis, which can be used for
geographical mapping of model outputs (as illustrated in . INLA spatial
analysis requires a prediction mesh. Generation of this mesh using <a href="../reference/new_mesh().html"><code>new_mesh()</code></a>. This
can be computationally expensive, so it is recommended to compute the
mesh just once for each dataset.</li>
</ul>
<p><code>CRTanalysis</code> is design to facilitate simulations of
different analytical methods for spatial CRTs by automating the data
processing and selecting appropriate analysis options. It does not
replace conventional use of these packages. The <code>CRTanalysis</code>
object that is returned includes the usual object output by the
statistical analysis package, which can be accessed by the usual methods
(e.g <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>,
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>). Real field trials very often entail complications
that are not catered for any of the analysis options in by the likely
to</p>
<table class="table">
<colgroup>
<col width="40%">
<col width="21%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>What it is</th>
<th>What it offers</th>
<th>Limitations</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>‘T’</td>
<td><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test" class="external-link">t.test</a></td>
<td>P-values and confidence intervals for efficacy based on comparison
of cluster means</td>
<td>No analysis of contamination or degree of clustering</td>
</tr>
<tr class="even">
<td>‘GEE’</td>
<td><a href="https://www.jstatsoft.org/article/view/v015i02" class="external-link">geepack</a></td>
<td>Interval estimates for efficacy and Intra-cluster correlations</td>
<td>No analysis of contamination or degree of clustering</td>
</tr>
<tr class="odd">
<td>‘INLA’</td>
<td><a href="https://www.r-inla.org/" class="external-link">INLA</a></td>
<td>Geostatistical analysis and spatially structured outputs</td>
<td>Computationally intensive</td>
</tr>
<tr class="even">
<td>‘MCMC’</td>
<td><a href="https://cran.r-project.org/web/packages/jagsUI/index.html" class="external-link">jagsUI</a></td>
<td>Interval estimates for contamination parameters</td>
<td>Identifiability issues and slow convergence are possible</td>
</tr>
</tbody>
</table>
<p>S: Sample proportions; ML: Maximum likelihood; GEE: Generalised
estimating equations; MCMC: Bayesian Markov chain Monte Carlo.</p>
<p>In each case the efficacy is estimated as <span class="math inline">\(\tilde{E}_{s} = 1-
\frac{\tilde{p}_{I}}{\tilde{p}_{C}}\)</span>.</p>
<p><span class="math inline">\(\hat{E}_{s} = 1-
\frac{\hat{p}_{I}}{\hat{p}_{C}}\)</span>. <span class="math inline">\(\hat{p}_{C} = \frac{1}{1 +
exp(-\beta_1)}\)</span>. <span class="math inline">\(\hat{p}_{I} =
\frac{1}{1 + exp(-\beta_1-\beta_2)}\)</span>.</p>
<p>To create a 100m INLA mesh for <code>&lt;MyTrial&gt;</code>, use:</p>
<p><code>mesh &lt;- new_mesh(trial = &lt;MyTrial&gt; , pixel = 0.1)</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span>trial<span class="op">=</span><span class="fu"><a href="../reference/readdata.html">readdata</a></span><span class="op">(</span><span class="st">'exampleCRT.csv'</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">'INLA'</span>, link<span class="op">=</span><span class="st">'logit'</span>, cfunc<span class="op">=</span><span class="st">'P'</span>,</span>
<span>  spatialEffects<span class="op">=</span> <span class="cn">TRUE</span>, requireMesh <span class="op">=</span> <span class="cn">TRUE</span>, inla_mesh <span class="op">=</span> <span class="fu"><a href="../reference/readdata.html">readdata</a></span><span class="op">(</span><span class="st">'examplemesh100.txt'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Estimating scale parameter for contamination range 
## 
DIC:  1361  Contamination scale parameter:  -2.361   

DIC:  1362  Contamination scale parameter:  2.361   

DIC:  1362  Contamination scale parameter:  -5.279   

DIC:  1362  Contamination scale parameter:  -2.282   

DIC:  1362  Contamination scale parameter:  -3.789   

DIC:  1362  Contamination scale parameter:  -2.906   

DIC:  1362  Contamination scale parameter:  -2.569   

DIC:  1362  Contamination scale parameter:  -2.44   

DIC:  1362  Contamination scale parameter:  -2.394   

DIC:  1362  Contamination scale parameter:  -2.327   

DIC:  1361  Contamination scale parameter:  -2.361   </code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysis</span>, map<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysis</span>, map<span class="op">=</span><span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">'prediction'</span><span class="op">)</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Thomas Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
