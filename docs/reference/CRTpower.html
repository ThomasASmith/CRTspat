<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="CRTpower carries out power and sample size calculations for CRTs."><title>Power and sample size calculations for a CRT — CRTpower • CRTspat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power and sample size calculations for a CRT — CRTpower"><meta property="og:description" content="CRTpower carries out power and sample size calculations for CRTs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CRTspat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/CRTspat.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Usecase1.html">Use Case 1: Algorithmic specification of clusters and of buffer zones</a>
    <a class="dropdown-item" href="../articles/Usecase2.html">Use Case 2: Simulation of trials with geographical contamination</a>
    <a class="dropdown-item" href="../articles/Usecase3.html">Use Case 3: Estimation of intracluster correlations (ICC) by cluster size</a>
    <a class="dropdown-item" href="../articles/Usecase4.html">Use Case 4: Estimation of optimal cluster size for a trial with pre-determined buffer width</a>
    <a class="dropdown-item" href="../articles/Usecase5.html">Use Case 5: Analysis of trials (including methods for analysing contamination)</a>
    <a class="dropdown-item" href="../articles/Usecase7.html">Use Case 7: Preparation of datasets for `CRTspat`</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Power and sample size calculations for a CRT</h1>
      
      <div class="d-none name"><code>CRTpower.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>CRTpower</code> carries out power and sample size calculations for CRTs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CRTpower</span><span class="op">(</span></span>
<span>  trial <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  locations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  desiredPower <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  effect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  phi <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ICC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd_h <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>trial</dt>
<dd><p>dataframe or <code>'CRTsp'</code> object containing Cartesian coordinates of locations in columns 'x' and 'y'.</p></dd>


<dt>locations</dt>
<dd><p>numeric: total number of units available for randomization (required if <code>trial</code> is not specified)</p></dd>


<dt>alpha</dt>
<dd><p>numeric: confidence level</p></dd>


<dt>desiredPower</dt>
<dd><p>numeric: desired power</p></dd>


<dt>effect</dt>
<dd><p>numeric: required effect size</p></dd>


<dt>yC</dt>
<dd><p>numeric: baseline value of outcome</p></dd>


<dt>outcome_type</dt>
<dd><p>character with options -
<code>'y'</code>: continuous;
<code>'n'</code>: count;
<code>'e'</code>: event rate;
<code>'p'</code>: proportion;
<code>'d'</code>: dichotomous.</p></dd>


<dt>sigma2</dt>
<dd><p>numeric: variance of the outcome (required for <code>outcome_type = 'y'</code>)</p></dd>


<dt>phi</dt>
<dd><p>numeric: overdispersion parameter (for <code>outcome_type = 'n'</code> or <code>outcome_type = 'e'</code>)</p></dd>


<dt>N</dt>
<dd><p>numeric: mean of the denominator for proportions (for <code>outcome_type = 'p'</code>)</p></dd>


<dt>ICC</dt>
<dd><p>numeric: Intra-Cluster Correlation</p></dd>


<dt>k</dt>
<dd><p>integer: number of clusters in each arm (required if <code>trial</code> is not specified)</p></dd>


<dt>sd_h</dt>
<dd><p>standard deviation of number of units per cluster (required if <code>trial</code> is not specified)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of class <code>'CRTsp'</code> object comprising the input data, cluster and arm assignments,
trial description and results of power calculations</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Power and sample size calculations are for a two-arm trial using the formulae of
<a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/1471-2288-11-102" class="external-link">Hemming et al, 2011</a> which use a
normal approximation for the inter-cluster variation. For counts
or event rate data a quasi–Poisson model is assumed. The functions do not consider any loss
in power due to contamination, loss to follow-up etc.
If geolocations are not input power and sample size calculations are based on the scalar input parameters.
If a trial dataframe or <code>'CRTsp'</code> object containing a pre-existing randomization is input then the
numbers and sizes of clusters are in the input data are used to estimate the power. If buffer zones have been specified
then separate calculations are made for the core area and for the full site<br>
The output is an object of class <code>'CRTsp'</code> containing any input trial data.frame and values for:</p><ul><li><p>The required numbers of clusters to achieve the specified power.<br></p></li>
<li><p>The design effect based on the input ICC.<br></p></li>
<li><p>Calculations of the nominal power (ignoring any bias caused by contamination effects)<br></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example without input geolocations</span></span></span>
<span class="r-in"><span><span class="va">examplePower</span> <span class="op">=</span> <span class="fu">CRTpower</span><span class="op">(</span>locations <span class="op">=</span> <span class="fl">3000</span>, ICC<span class="op">=</span><span class="fl">0.10</span>, effect<span class="op">=</span><span class="fl">0.4</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>    outcome_type <span class="op">=</span> <span class="st">'d'</span>, desiredPower <span class="op">=</span> <span class="fl">0.8</span>, yC<span class="op">=</span><span class="fl">0.35</span>, k <span class="op">=</span> <span class="fl">20</span>, sd_h<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** All of geoscale, locations, kappa, mu needed to simulate a new site ***</span>
<span class="r-in"><span><span class="co"># Example with input geolocations and randomisation</span></span></span>
<span class="r-in"><span><span class="va">examplePower</span> <span class="op">=</span> <span class="fu">CRTpower</span><span class="op">(</span>trial <span class="op">=</span> <span class="fu"><a href="readdata.html">readdata</a></span><span class="op">(</span><span class="st">'example_site.csv'</span><span class="op">)</span>, desiredPower <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    effect<span class="op">=</span><span class="fl">0.4</span>, yC<span class="op">=</span><span class="fl">0.35</span>, outcome_type <span class="op">=</span> <span class="st">'d'</span>, ICC <span class="op">=</span> <span class="fl">0.05</span>, k <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Assuming all clusters are the same size ***</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Thomas Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

