df <- df[df$etat_pieges == 'Bon', c(vars0, vars1)]
df2 <- read.csv(file =
'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/FICHE_BG_SENTINELS_SNIS_int_only_cleaned.csv')
df2 <- dplyr::rename(df2, semaine = sem_,
code = code_moust,
lat = gps.Latitude,
long = gps.Longitude)
df3 <- rbind(df2,df2)
df3$especes <- c(rep('Aedes aegypti', times = nrow(df2)),
rep('Culex quinquefasciatus', times = nrow(df2)))
vars_ae <- c("q1ae", "numb_fed", "numb_unfed", "numb_half_gravid", "numb_gravid", "sum_q1ae_q2ae",
"aedes_disseq", "numb_pare", "numb_nullip")
vars_cuq <- c("q1cuq", "numb_fed.2", "numb_unfed.2", "numb_half_gravid.2", "numb_gravid.2", "sum_q1cuq_q2cuq")
for(v in 1:6) {
df3[[vars1[v]]] <- ifelse(df3$especes == 'Aedes aegypti',
df3[[vars_ae[v]]],
df3[[vars_cuq[v]]])
}
for(v in 7:9) {
df3[[vars1[v]]] <- ifelse(df3$especes == 'Aedes aegypti',
df3[[vars_ae[v]]],
NA)
}
df3 <- df3[df3$trap_func == 1, c(vars0, vars1)]
alldata <- rbind(df, df3)
traps <- distinct(alldata, date, semaine, code, lat, long)
traps <- traps[!is.na(traps$code),]
traps$intervention <- as.Date(traps$date,'%d/%m/%Y') > as.Date('20/07/2023','%d/%m/%Y')
aedes <- alldata[alldata$especes == "Aedes aegypti", ]
aedes <- merge(traps, aedes, by=c("date", "semaine", "code", "lat", "long"),
all.x = TRUE)
aedes$total_femelle[is.na(aedes$total_femelle)] <- 0
aedes$especes[is.na( aedes$especes)] <- "Aedes aegypti"
culex <- alldata[alldata$especes == "Culex quinquefasciatus", ]
culex <- merge(traps, culex, by=c("date", "semaine", "code", "lat", "long"),
all.x = TRUE)
culex$total_femelle[is.na(culex$total_femelle)] <- 0
culex$especes[is.na(culex$especes)] <- "Culex quinquefasciatus"
return(list(aedes = aedes, culex = culex))}
stats_by_group <- function(data, groupvar) {
data$groupvar <- data[[groupvar]]
tab <- data %>% group_by(groupvar) %>%
summarize(nobs = sum(!is.na(total_femelle)),
mean = mean(total_femelle),
median = quantile(total_femelle, 0.5),
q1 = quantile(total_femelle, 0.25),
q3 = quantile(total_femelle, 0.75),
ppos = mean(total_femelle > 0))
return(tab)}
snis <- readSNISdata()
readSNISdata <- function() {
vars0 <- c('date','semaine','code', 'lat', 'long', 'especes')
vars1 <- c("male", "gorge", "a_jeun", "semi_gravide", "gravide", "total_femelle",
"disseque", "pare", "nullipare")
df <- read.csv(
file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/Snis_17_06_24_manual_clean_locations.csv')
df$especes[df$especes == "aedes aegypti"] <- "Aedes aegypti"
df <- df[df$etat_pieges == 'Bon', c(vars0, vars1)]
df2 <- read.csv(file =
'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/FICHE_BG_SENTINELS_SNIS_int_only_cleaned.csv')
df2 <- dplyr::rename(df2, semaine = sem_,
code = code_moust,
lat = gps.Latitude,
long = gps.Longitude)
df3 <- rbind(df2,df2)
df3$especes <- c(rep('Aedes aegypti', times = nrow(df2)),
rep('Culex quinquefasciatus', times = nrow(df2)))
vars_ae <- c("q1ae", "numb_fed", "numb_unfed", "numb_half_gravid", "numb_gravid", "sum_q1ae_q2ae",
"aedes_disseq", "numb_pare", "numb_nullip")
vars_cuq <- c("q1cuq", "numb_fed.2", "numb_unfed.2", "numb_half_gravid.2", "numb_gravid.2", "sum_q1cuq_q2cuq")
for(v in 1:6) {
df3[[vars1[v]]] <- ifelse(df3$especes == 'Aedes aegypti',
df3[[vars_ae[v]]],
df3[[vars_cuq[v]]])
}
for(v in 7:9) {
df3[[vars1[v]]] <- ifelse(df3$especes == 'Aedes aegypti',
df3[[vars_ae[v]]],
NA)
}
df3 <- df3[df3$trap_func == 1, c(vars0, vars1)]
alldata <- rbind(df, df3)
traps <- distinct(alldata, date, semaine, code, lat, long)
traps <- traps[!is.na(traps$code),]
traps$intervention <- as.Date(traps$date,'%d/%m/%Y') > as.Date('20/07/2023','%d/%m/%Y')
aedes <- alldata[alldata$especes == "Aedes aegypti", ]
aedes <- merge(traps, aedes, by=c("date", "semaine", "code", "lat", "long"),
all.x = TRUE)
aedes$total_femelle[is.na(aedes$total_femelle)] <- 0
aedes$especes[is.na( aedes$especes)] <- "Aedes aegypti"
culex <- alldata[alldata$especes == "Culex quinquefasciatus", ]
culex <- merge(traps, culex, by=c("date", "semaine", "code", "lat", "long"),
all.x = TRUE)
culex$total_femelle[is.na(culex$total_femelle)] <- 0
culex$especes[is.na(culex$especes)] <- "Culex quinquefasciatus"
return(list(aedes = aedes, culex = culex))}
stats_by_group <- function(data, groupvar) {
data$groupvar <- data[[groupvar]]
tab <- data %>% group_by(groupvar) %>%
summarize(nobs = sum(!is.na(total_femelle)),
mean = mean(total_femelle),
median = quantile(total_femelle, 0.5),
q1 = quantile(total_femelle, 0.25),
q3 = quantile(total_femelle, 0.75),
ppos = mean(total_femelle > 0))
return(tab)}
snis <- readSNISdata()
write.csv(rbind(snis$aedes, snis$culex), file = 'SNIS_BGtraps_ts.csv')
# tabulations of basic data
table(snis$aedes$intervention)
tab <- table(snis$aedes$code, snis$aedes$intervention)
summary(tab[,1])
summary(tab[,2])
stats_by_group(snis$aedes, 'intervention')
stats_by_group(snis$culex, 'intervention')
stats_by_group(snis$aedes, 'especes')
stats_by_group(snis$culex, 'especes')
library(ggplot2)
theme_set(theme_bw(base_size = 12))
# Plot means by trial phase (intervention starts 16/07/2023)
ggplot(data = snis$aedes, aes(x = as.Date(date,'%d/%m/%Y'), y = total_femelle)) +
geom_smooth(colour = 'red') +
geom_smooth(data = snis$culex, colour = 'blue') +
geom_vline(xintercept = as.Date('20/07/2023','%d/%m/%Y')) +
geom_vline(xintercept = as.Date('20/07/2024','%d/%m/%Y')) +
xlab('Date') +
ylab('Mean females per trap')
# plot map of assigned clusters
library(CRTspat)
library(dplyr)
snis$aedes$cluster <- snis$aedes$code
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/smith/Documents/documents/Current Projects/Mueller/snis.dengue.crt.pixels.csv')
pixels$cluster <- with(pixels, factor(ifelse(site == 'Anono', cluster + 100, cluster + 200)))
pixels <- pixels[order(pixels$cluster),]
clustercentroids <- function(pixels) {
# compute the cluster centroids
clusters <- pixels %>%
dplyr::group_by(cluster) %>%
dplyr::summarize(lat = mean(lat), long = mean(long))
clusterCRT <- CRTsp(clusters, geometry = 'point') %>% latlong_as_xy()
}
clusterCRT <- clustercentroids(pixels)
# Analyse only baseline data (for power analysis)
CRT <- CRTsp(snis$aedes[!snis$aedes$intervention, ]) %>%
latlong_as_xy() %>%
compute_distance(distance = "distanceAssigned", auxiliary = clusterCRT)
CRT$trial$distanceAssignedCentroid <- CRT$trial$distanceAssigned
pixelCRT <- CRTsp(pixels, geometry = 'square') %>% latlong_as_xy()
CRT <- compute_distance(CRT, distance = "distanceAssigned", auxiliary = pixelCRT)
# reassign the clusters to match the nearest to the recorded location
CRT$trial$clusterAssigned <- CRT$trial$cluster
CRT$trial$cluster <- NULL
CRT$trial$distanceAssigned0 <- CRT$trial$distanceAssigned
CRT <- specify_clusters(CRT, auxiliary = pixelCRT)
CRT <- compute_distance(CRT, distance = "distanceAssigned", auxiliary = clusterCRT)
names(CRT$trial)[names(CRT$trial) == 'distanceAssigned'] <- 'distanceClusterCentroid'
pixelCRT <- compute_distance(pixelCRT, distance = "distanceAssigned", auxiliary = clusterCRT)
# reassign the clusters to match the nearest to the recorded location
CRT$trial$clusterAssigned <- CRT$trial$cluster
CRT$trial$cluster <- NULL
CRT$trial$distanceAssigned0 <- CRT$trial$distanceAssigned
CRT <- specify_clusters(CRT, auxiliary = pixelCRT)
pixelCRT <- CRTsp(pixels, geometry = 'square') %>% latlong_as_xy()
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/smith/Documents/documents/Current Projects/Mueller/snis.dengue.crt.pixels.csv')
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/SNIS/snis.dengue.crt.pixels.csv')
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/SNIS/snis.dengue.crt.pixels.csv')
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/SNIS/snis.dengue.crt.pixels.csv')
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/SNIS/snis.dengue.crt.pixels.csv')
.
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/snis.dengue.crt.pixels.csv')
pixels$cluster <- with(pixels, factor(ifelse(site == 'Anono', cluster + 100, cluster + 200)))
pixels <- pixels[order(pixels$cluster),]
clustercentroids <- function(pixels) {
# compute the cluster centroids
clusters <- pixels %>%
dplyr::group_by(cluster) %>%
dplyr::summarize(lat = mean(lat), long = mean(long))
clusterCRT <- CRTsp(clusters, geometry = 'point') %>% latlong_as_xy()
}
clusterCRT <- clustercentroids(pixels)
# Analyse only baseline data (for power analysis)
CRT <- CRTsp(snis$aedes[!snis$aedes$intervention, ]) %>%
latlong_as_xy() %>%
compute_distance(distance = "distanceAssigned", auxiliary = clusterCRT)
library(dplyr)
readSNISdata <- function() {
vars0 <- c('date','semaine','code', 'lat', 'long', 'especes')
vars1 <- c("male", "gorge", "a_jeun", "semi_gravide", "gravide", "total_femelle",
"disseque", "pare", "nullipare")
df <- read.csv(
file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/Snis_17_06_24_manual_clean_locations.csv')
df$especes[df$especes == "aedes aegypti"] <- "Aedes aegypti"
df <- df[df$etat_pieges == 'Bon', c(vars0, vars1)]
df2 <- read.csv(file =
'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/FICHE_BG_SENTINELS_SNIS_int_only_cleaned.csv')
df2 <- dplyr::rename(df2, semaine = sem_,
code = code_moust,
lat = gps.Latitude,
long = gps.Longitude)
df3 <- rbind(df2,df2)
df3$especes <- c(rep('Aedes aegypti', times = nrow(df2)),
rep('Culex quinquefasciatus', times = nrow(df2)))
vars_ae <- c("q1ae", "numb_fed", "numb_unfed", "numb_half_gravid", "numb_gravid", "sum_q1ae_q2ae",
"aedes_disseq", "numb_pare", "numb_nullip")
vars_cuq <- c("q1cuq", "numb_fed.2", "numb_unfed.2", "numb_half_gravid.2", "numb_gravid.2", "sum_q1cuq_q2cuq")
for(v in 1:6) {
df3[[vars1[v]]] <- ifelse(df3$especes == 'Aedes aegypti',
df3[[vars_ae[v]]],
df3[[vars_cuq[v]]])
}
for(v in 7:9) {
df3[[vars1[v]]] <- ifelse(df3$especes == 'Aedes aegypti',
df3[[vars_ae[v]]],
NA)
}
df3 <- df3[df3$trap_func == 1, c(vars0, vars1)]
alldata <- rbind(df, df3)
traps <- distinct(alldata, date, semaine, code, lat, long)
traps <- traps[!is.na(traps$code),]
traps$intervention <- as.Date(traps$date,'%d/%m/%Y') > as.Date('20/07/2023','%d/%m/%Y')
aedes <- alldata[alldata$especes == "Aedes aegypti", ]
aedes <- merge(traps, aedes, by=c("date", "semaine", "code", "lat", "long"),
all.x = TRUE)
aedes$total_femelle[is.na(aedes$total_femelle)] <- 0
aedes$especes[is.na( aedes$especes)] <- "Aedes aegypti"
culex <- alldata[alldata$especes == "Culex quinquefasciatus", ]
culex <- merge(traps, culex, by=c("date", "semaine", "code", "lat", "long"),
all.x = TRUE)
culex$total_femelle[is.na(culex$total_femelle)] <- 0
culex$especes[is.na(culex$especes)] <- "Culex quinquefasciatus"
return(list(aedes = aedes, culex = culex))}
stats_by_group <- function(data, groupvar) {
data$groupvar <- data[[groupvar]]
tab <- data %>% group_by(groupvar) %>%
summarize(nobs = sum(!is.na(total_femelle)),
mean = mean(total_femelle),
median = quantile(total_femelle, 0.5),
q1 = quantile(total_femelle, 0.25),
q3 = quantile(total_femelle, 0.75),
ppos = mean(total_femelle > 0))
return(tab)}
snis <- readSNISdata()
write.csv(rbind(snis$aedes, snis$culex), file = 'SNIS_BGtraps_ts.csv')
# tabulations of basic data
table(snis$aedes$intervention)
tab <- table(snis$aedes$code, snis$aedes$intervention)
summary(tab[,1])
summary(tab[,2])
stats_by_group(snis$aedes, 'intervention')
stats_by_group(snis$culex, 'intervention')
stats_by_group(snis$aedes, 'especes')
stats_by_group(snis$culex, 'especes')
library(ggplot2)
theme_set(theme_bw(base_size = 12))
# Plot means by trial phase (intervention starts 16/07/2023)
ggplot(data = snis$aedes, aes(x = as.Date(date,'%d/%m/%Y'), y = total_femelle)) +
geom_smooth(colour = 'red') +
geom_smooth(data = snis$culex, colour = 'blue') +
geom_vline(xintercept = as.Date('20/07/2023','%d/%m/%Y')) +
geom_vline(xintercept = as.Date('20/07/2024','%d/%m/%Y')) +
xlab('Date') +
ylab('Mean females per trap')
# plot map of assigned clusters
library(CRTspat)
library(dplyr)
snis$aedes$cluster <- snis$aedes$code
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/snis.dengue.crt.pixels.csv')
pixels$cluster <- with(pixels, factor(ifelse(site == 'Anono', cluster + 100, cluster + 200)))
pixels <- pixels[order(pixels$cluster),]
clustercentroids <- function(pixels) {
# compute the cluster centroids
clusters <- pixels %>%
dplyr::group_by(cluster) %>%
dplyr::summarize(lat = mean(lat), long = mean(long))
clusterCRT <- CRTsp(clusters, geometry = 'point') %>% latlong_as_xy()
}
clusterCRT <- clustercentroids(pixels)
# Analyse only baseline data (for power analysis)
CRT <- CRTsp(snis$aedes[!snis$aedes$intervention, ]) %>%
latlong_as_xy() %>%
compute_distance(distance = "distanceAssigned", auxiliary = clusterCRT)
CRT$trial$distanceAssignedCentroid <- CRT$trial$distanceAssigned
pixelCRT <- CRTsp(pixels, geometry = 'square') %>% latlong_as_xy()
CRT <- compute_distance(CRT, distance = "distanceAssigned", auxiliary = pixelCRT)
# reassign the clusters to match the nearest to the recorded location
CRT$trial$clusterAssigned <- CRT$trial$cluster
CRT$trial$cluster <- NULL
CRT$trial$distanceAssigned0 <- CRT$trial$distanceAssigned
CRT <- specify_clusters(CRT, auxiliary = pixelCRT)
CRT <- compute_distance(CRT, distance = "distanceAssigned", auxiliary = clusterCRT)
names(CRT$trial)[names(CRT$trial) == 'distanceAssigned'] <- 'distanceClusterCentroid'
pixelCRT <- compute_distance(pixelCRT, distance = "distanceAssigned", auxiliary = clusterCRT)
names(pixelCRT$trial)[names(pixelCRT$trial) == 'distanceAssigned'] <- 'distanceClusterCentroid'
plotCRT(pixelCRT, map = TRUE)
View(pixelCRT)
plotCRT(pixelCRT, map = TRUE, buffer_width = 0.1)
plotCRT(pixelCRT, map = TRUE)
plotCRT(pixelCRT, map = TRUE, maskbuffer = 0.1)
pixelCRT$trial$buffer <- NA
plotCRT(pixelCRT, map = TRUE, maskbuffer = 0.1)
pixelCRT$trial$buffer <- ifelse(pixelCRT$trial$bufferZone == "Yes", TRUE, FALSE)
plotCRT(pixelCRT, map = TRUE, maskbuffer = 0.1)
plot <- plotCRT(pixelCRT, map = TRUE, maskbuffer = 0.1)
plot <- plotCRT(pixelCRT, map = TRUE, showLocations = TRUE, maskbuffer = 0.1)
plot
plot + ggplot2::geom_point(data = pixelCRT$trial, aes(x = x, y = y), size = 0.5)
plot <- plotCRT(pixelCRT, map = TRUE, maskbuffer = 0.1)
plot
plot + ggplot2::geom_point(data = pixelCRT$trial, aes(x = x, y = y), size = 0.1)
plot <- plotCRT(pixelCRT, map = TRUE, showClusters = TRUE, maskbuffer = 0.1)
plot <- plotCRT(pixelCRT, map = TRUE, showCluster = TRUE, maskbuffer = 0.1)
plot <- plotCRT(pixelCRT, map = TRUE, showClusterBoundaries = TRUE, maskbuffer = 0.1)
plot
View(clusterCRT)
plot + geom_point(data = clusterCRT$trial, aes(x = x, y = y), size = 0.1)
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1)
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red")
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_y_continuous(breaks = seq(1:11)-5)
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_y_continuous(breaks = (seq(1:11)-5))
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_x_continuous(breaks = (seq(1:11)-5))
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_x_continuous(breaks = (seq(1:12)-5))
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_x_continuous(minor_breaks = (seq(1:25)-10)/2)
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_x_continuous(breaks = (seq(1:12)-5))
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_x_continuous(limits = c(-6, 6), breaks = (seq(1:12)-5))
plot + geom_point(data = CRT$trial, aes(x = x, y = y), size = 0.1, colour = "red") + scale_x_continuous(limits = c(-6, 6), breaks = (seq(1:12)-6))
df <- read.csv(
file = 'C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/Snis_17_06_24_manual_clean_locations.csv')
df$especes[df$especes == "aedes aegypti"] <- "Aedes aegypti"
df <- df[df$etat_pieges == 'Bon', c(vars0, vars1)]
library(CRTspat)
library(dplyr)
snis$aedes$cluster <- snis$aedes$code
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = 'C:/Users/smith/Documents/documents/Current Projects/Mueller/snis.dengue.crt.pixels.csv')
pixels$cluster <- with(pixels, factor(ifelse(site == 'Anono', cluster + 100, cluster + 200)))
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = '"C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/snis.dengue.crt.pixels.csv')
pixels$cluster <- with(pixels, factor(ifelse(site == 'Anono', cluster + 100, cluster + 200)))
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = "C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/snis.dengue.crt.pixels.csv")
# construct the list of all pixels and compute xy coordinates
pixels <- read.csv(file = "C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/snis.dengue.crt.pixels.csv")
pixels$cluster <- with(pixels, factor(ifelse(site == 'Anono', cluster + 100, cluster + 200)))
pixels <- pixels[order(pixels$cluster),]
clustercentroids <- function(pixels) {
# compute the cluster centroids
clusters <- pixels %>%
dplyr::group_by(cluster) %>%
dplyr::summarize(lat = mean(lat), long = mean(long))
clusterCRT <- CRTsp(clusters, geometry = 'point') %>% latlong_as_xy()
}
clusterCRT <- clustercentroids(pixels)
# Analyse only baseline data (for power analysis)
CRT <- CRTsp(snis$aedes[!snis$aedes$intervention, ]) %>%
latlong_as_xy() %>%
compute_distance(distance = "distanceAssigned", auxiliary = clusterCRT)
# construct the list of all pixels and compute xy coordinates
snis <- read.csv(file = 'SNIS_BGtraps_ts.csv')
tab <- table(snis$aedes$code, snis$aedes$intervention)
# Reading Binka Data
library(readr)
library(zen4R)
rm(CRT)
invisible(
zen4R::download_zenodo(doi = "10.5281/zenodo.14931738", path = ".",
files = list("samuel-watson/spatial_trials-v1.1.zip")))
CRT <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS")) %>%
transmute(base_denom = 1, x = -x, y) %>%
filter(abs(x)< 5 & abs(y)< 5) %>%
CRTsp() %>% aggregateCRT()
library(CRTspat)
library(dplyr)
library(ggplot2)
library(readr)
library(zen4R)
rm(CRT)
invisible(
zen4R::download_zenodo(doi = "10.5281/zenodo.14931738", path = ".",
files = list("samuel-watson/spatial_trials-v1.1.zip")))
CRT <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS")) %>%
transmute(base_denom = 1, x = -x, y) %>%
filter(abs(x)< 5 & abs(y)< 5) %>%
CRTsp() %>% aggregateCRT()
file.remove("spatial_trials-v1.1.zip")
source('C:/Users/thoma.TOM2025/Documents/Current Projects/Mueller/SNIS/SNIS CRTspat analysis.R')
control <- list(iter = 2000, max_treedepth = 20)
analysis <- CRTanalysis(CRT = 'snisCRT', method = "MCMC", link = 'log', cfunc = "D", numerator = "total_femelle", results = results, control=control)
analysis <- CRTanalysis(CRT = snisCRT, method = "MCMC", link = 'log', cfunc = "D", numerator = "total_femelle", control=control)
analysis <- CRTanalysis(trial = snisCRT, method = "MCMC", link = 'log', cfunc = "D", numerator = "total_femelle", control=control)
plotCRT(analysis)
summary(analysis)
head(snisCRT$trial)
head(assignments)
head(assignments)
? analyseCRT
? CRTanalysis
analyses <- list()
analyses$SNIS_traps_D <- analysis
head(CRT)
summary(CRT)
rm(CRT)
View(clusterCRT)
summary(clusterCRT)
invisible(
zen4R::download_zenodo(doi = "10.5281/zenodo.14931738", path = ".",
files = list("samuel-watson/spatial_trials-v1.1.zip")))
CRT <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS")) %>%
transmute(base_denom = 1, x = -x, y) %>%
filter(abs(x)< 5 & abs(y)< 5) %>%
CRTsp() %>% aggregateCRT()
head(CRT$trial)
rm(CRT)
invisible(
zen4R::download_zenodo(doi = "10.5281/zenodo.14931738", path = ".",
files = list("samuel-watson/spatial_trials-v1.1.zip")))
file.remove("spatial_trials-v1.1.zip")
invisible(
zen4R::download_zenodo(doi = "10.5281/zenodo.14931738", path = ".",
files = list("samuel-watson/spatial_trials-v1.1.zip")))
library(readr)
library(zen4R)
CRT <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE, files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS"))
rm(CRT)
invisible(
zen4R::download_zenodo(doi = "10.5281/zenodo.14931738", path = ".",
files = list("samuel-watson/spatial_trials-v1.1.zip")))
binka <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS")) %>%
CRTsp() %>% aggregateCRT()
binka <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS"))
head(binka)
binkaCRT <- binka %>% mutate(x = -x)
head(binkaCRT)
binkaCRT <- binka %>% mutate(x = -x, cluster = cl, arm, deaths, denom = expected)
head(binkaCRT)
? mutate
binkaCRT <- binka %>% mutate(x = -x, cluster = cl, arm, deaths, denom = expected, keep = 'none')
head(binkaCRT)
binkaCRT <- binka %>% data.frame() %>% mutate(x = -x, cluster = cl, arm, deaths, denom = expected, keep = 'none')
head(binkaCRT)
binkaCRT <- binka %>% data.frame() %>% mutate(x = -x, cluster = cl, arm, deaths, denom = expected, dp = NULL, expected = NULL, distance = NULL, distance_all = NULL, x_re = NULL, y_re = NULL)
head(binkaCRT)
binkaCRT <- binka %>% data.frame() %>% mutate(x = -x, cluster = cl, arm, deaths, denom = expected, dp = NULL, expected = NULL, distance = NULL, distance_all = NULL, x_re = NULL, y_re = NULL, cl = NULL)
head(binkaCRT)
binkaCRT <- binka %>% data.frame() %>% mutate(x = -x, cluster = cl, arm, deaths, denom = expected, dp = NULL, expected = NULL, distance = NULL, distance_all = NULL, x_re = NULL, y_re = NULL, cl = NULL)
table(binkaCRT$nets)
? transmute
? filter
table(binkaCRT$arm)
table(binkaCRT$cluster, binkaCRT$arm)
table(binkaCRT$cluster, binkaCRT$nets)
? aggregateCRT
binkaCRT <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS")) %>%
filter(nets > 0) %>%
mutate(x = -x, cluster = cl, arm, deaths, denom = expected, .keep = 'none') %>%
CRTsp() %>% aggregateCRT(auxiliaries = c('deaths', 'denom'))
binkaCRT <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS")) %>%
filter(nets > 0) %>%
mutate(x = -x, cluster = cl, arm, deaths, denom = expected, .keep = 'none')
head(binkaCRT)
binkaCRT <- read_rds(utils::unzip(zipfile = "spatial_trials-v1.1.zip", overwrite = TRUE,
files = "samuel-watson-spatial_trials-0335466/data/binka_analysis_data.RDS")) %>%
filter(nets > 0) %>%
mutate(x = -x, y, cluster = cl, arm, deaths, denom = expected, .keep = 'none') %>%
CRTsp() %>% aggregateCRT(auxiliaries = c('deaths', 'denom'))
head(binkaCRT$trial)
plotCRT(binkaCRT, map = TRUE)
? CRTanalysis
summary(binkaCRT$trial$deaths)
summary(binkaCRT$trial$expect)
summary(binkaCRT$trial$denom)
analyses$binka_D <- CRTanalysis(trial = binkaCRT, method = "MCMC",
link = 'log', cfunc = "D", numerator = "deaths",
denominator = 'denom', control=control)
summary(analyses$binka_D)
View(analyses)
analyses$binka_D <- CRTanalysis(trial = binkaCRT, method = "MCMC",
link = 'log', cfunc = "D", numerator = "deaths",
denominator = 'denom', control=control)
warnings()
summary(analyses$binka_D)
plotCRT(analyses$binka_D)
plotCRT(analyses$binka_D, map = TRUE)
analyses$binka_Dasym <- CRTanalysis(trial = binkaCRT, method = "MCMC",
link = 'log', cfunc = "D", numerator = "deaths", asymmetry = TRUE,
denominator = 'denom', control=control)
load("~/Current Projects/Multerer/factorialanalysis/stananalyses.RData")
rm(analyses)
binkaD<- CRTanalysis(trial = binkaCRT, method = "MCMC", link = 'log', cfunc = "D", numerator = "deaths", control=control)
library(CRTspat)
library(dplyr)
library(ggplot2)
binkaD<- CRTanalysis(trial = binkaCRT, method = "MCMC", link = 'log', cfunc = "D", numerator = "deaths", control=control)
summary(binkaD)
binkaD<- CRTanalysis(trial = binkaCRT, method = "MCMC", link = 'log', cfunc = "D", numerator = "deaths", control=control)
summary(binkaD)
save.image("~/Current Projects/Multerer/factorialanalysis/stananalyses.RData")
plotCRT(binkaD)
