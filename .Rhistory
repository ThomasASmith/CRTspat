#spatial <- c(TRUE,FALSE)
scenarios <- data.frame(method = ' ',
cfunc = ' ',
link = ' ',
#                        baselineOnly = FALSE,
#                        personalProtection = FALSE,
#                        clusterEffects = FALSE,
#                        spatialEffects = FALSE,
controlY = -9,
effect_size = -9,
ftext = 'No formula')
sno = 0
for (method in methods){
for (cfunc in cfuncs){
for (link in links){
#      for (baselineOnly in baseline){
#        for (personalProtection in personal){
#          for (clusterEffects in cluster){
#            for (spatialEffects in spatial){
cat(method,cfunc,link,"\n")
scenario <- data.frame(
method = method,
cfunc =  cfunc,
link =  link,
#              baselineOnly =  baselineOnly,
#              personalProtection =  FALSE,
#              clusterEffects =  FALSE,
#              spatialEffects =  FALSE,
controlY = -9,
effect_size = -9,
ftext = 'No formula')
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
scenario$controlY <- ifelse(is.null(results$pt_ests$controlY), -8,results$pt_ests$controlY)
scenario$effect_size <- ifelse(is.null(results$pt_ests$effect_size),-8,results$pt_ests$effect_size)
scenario$ftext <- ifelse(is.null(results$options$ftext),'Not defined',results$options$ftext)
scenarios <- rbind(scenarios,scenario)
sno <- sno + 1
cat(sno, "\n")
}}}
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
View(sample)
analysis$model_object <- model_object
sample$contamination_par <- sample$beta
contamination_list <- apply(sample, MARGIN = 1, FUN = get_contamination, analysis = analysis)
contamination_list <- apply(sample, MARGIN = 2, FUN = get_contamination, analysis = analysis)
head(sample)
alpha <- analysis$options$alpha
link <- analysis$options$link
method <- analysis$options$method
CLnames <- analysis$options$CLnames
sample$controlY <- invlink(link, sample$int)
# personal_protection is the proportion of effect attributed to personal protection
if ("arm" %in% names(sample) & "pvar" %in% names(sample)) {
if (identical(method,"LME4")) sample$lc <- with(sample, int + pvar + arm)
sample$interventionY <- invlink(link, sample$lc)
sample$personal_protection <- with(
sample, (controlY - invlink(link, int + arm))/(controlY -
interventionY))
}
if ("arm" %in% names(sample) & !("pvar" %in% names(sample))) {
sample$interventionY <- invlink(link, sample$int + sample$arm)
sample$personal_protection <- NULL
}
if ("pvar" %in% names(sample) & !("arms" %in% names(sample))) {
sample$interventionY <- invlink(link, sample$int + sample$pvar)
sample$personal_protection <- NULL
}
library(CRTspat)
library(CRTspat)
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
analysis$model_object <- model_object
analysis <- extractEstimates(analysis = analysis, sample = sample)
analysis$pt_ests$DIC <- model_object$DIC
analysis$pt_ests$DIC <- model_object$DIC
pt_ests
rabbit <- list()
rabbit[["dsfa"]] <- 6
rabbit
devtools::load_all(".")
bounds
bounds()
library(CRTspat)
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
library(CRTspat)
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
plotCRT(results)
results$pt_ests
library(CRTspat)
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
library(CRTspat)
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
library(CRTspat)
results <- CRTanalysis(example, method = method,
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
library(CRTspat)
summary(results)
library(CRTspat)
summary(results)
library(CRTspat)
summary(results)
library(CRTspat)
summary(results)
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
View(results)
results$contamination
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= cfunc,
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
results <- CRTanalysis(example, method = 'LME4',
cfunc= Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
rabbit
rabbit[['wom']]
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
curve()
curve
d
FUN1
x
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(model_object)$coefficients[,1]
sample <- as.data.frame(MASS::mvrnorm(n = 10000, mu = q50, Sigma = cov))
q50 <- summary(model_object)$coefficients[,1]
q50
summary(model_object)$coefficients
ftext
names(q50)
cov
model_object
summary(results)
View(model_object)
View(model_object)
model_object
summary(model_object)$coefficients[,1]
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
results$contamination
results$options$cfunc
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
results$pt_ests
results$contamination
library(CRTspat)
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "Z",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "X",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
plotCRT(results)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
results$contamination
results$pt_ests
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
library(CRTspat)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
results$pt_ests
summary(results)
plotCRT(results)
results <- CRTanalysis(example, method = 'MCMC',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
results <- CRTanalysis(example, method = 'MCMC',
cfunc= "L",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
results <- CRTanalysis(example, method = 'INLA',
cfunc= "L",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
plotCRT(results)
results <- CRTanalysis(example, method = 'INLA',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
results <- CRTanalysis(example, method = 'INLA',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
summary(results)
plotCRT(results)
results <- CRTanalysis(example, method = 'MCMC',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
library(CRTspat)
results <- CRTanalysis(example, method = 'MCMC',
cfunc= "P",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
results <- CRTanalysis(example, method = 'LME4',
cfunc= "S",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
plotCRT(results)
results <- CRTanalysis(example, method = 'INLA',
cfunc= "S",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
plotCRT(results)
summary(results)
results <- CRTanalysis(example, method = 'MCMC',
cfunc= "S",
link= link,
baselineOnly= FALSE,
personalProtection= FALSE,
clusterEffects= TRUE,
spatialEffects =  FALSE,
requireMesh = TRUE,
inla_mesh = exmesh)
summary(results)
plotCRT(results)
library(CRTspat)
library(CRTspat)
plotCRT(results)
